import Day20.parse
import Day20.run1
import Day20.run2
import kotlin.Int
import kotlin.math.absoluteValue

object Day20 {
    fun parse(input: String) = Grid.parseCharGrid(input)

    data class Cheat(val from: Coordinate<Int>, val to: Coordinate<Int>, val less: Int)

    fun findCheat2(grid: Grid<Int?>, c: Coordinate<Int>, cheatTime: Int = 20): List<Cheat> {
        val from = grid.get(c)!!
        val cheats = (-cheatTime).rangeTo(cheatTime).flatMap { dx ->
            val cheatLeft = cheatTime - dx.absoluteValue
            (-cheatLeft).rangeTo(cheatLeft).mapNotNull { dy ->
                val cheated = dx.absoluteValue + dy.absoluteValue
                val toC = Coordinate.create(c.x + dx, c.y + dy)
                grid.getSafe(toC)?.let { it - from - cheated }?.let { safe ->
                    if (safe > 0) Cheat(c, toC, safe) else null
                }
            }
        }
        return cheats
    }

    fun run(input: Grid<Char>, saveAtLeast: Int, cheatTime: Int): Int {
        val path = aStar(Maze(input))!!
        val numberedPath = path.foldIndexed(Grid.init<Int?>(input.width(), input.height(), null)) { i, g, e ->
            g.set(e, i)
        }
        val cheats = path.toList().flatMap { findCheat2(numberedPath, it, cheatTime) }
        return cheats.count { it.less >= saveAtLeast }
    }

    fun run1(input: Grid<Char>, saveAtLeast: Int) = run(input, saveAtLeast, 2)

    fun run2(input: Grid<Char>, saveAtLeast: Int) = run(input, saveAtLeast, 20)
}

fun main() {
    val input = """
        #############################################################################################################################################
        #.............#...#.....#...#.......###...#.....#...#...#.....#...#.......#.............#...#...#...#.....#.......#...#.........#...#.......#
        #.###########.#.#.#.###.#.#.#.#####.###.#.#.###.#.#.#.#.#.###.#.#.#.#####.#.###########.#.#.#.#.#.#.#.###.#.#####.#.#.#.#######.#.#.#.#####.#
        #...........#.#.#.#...#.#.#.#.#.....#...#.#...#.#.#.#.#.#...#.#.#.#.....#.#.........#...#.#.#.#.#.#.#...#...#.....#.#.#.#.......#.#...#...#.#
        ###########.#.#.#.###.#.#.#.#.#.#####.###.###.#.#.#.#.#.###.#.#.#.#####.#.#########.#.###.#.#.#.#.#.###.#####.#####.#.#.#.#######.#####.#.#.#
        #...###...#.#...#.#...#...#...#.....#...#.###.#.#.#.#.#.###.#...#...###.#.###...#...#.###.#...#...#.###.#...#.#...#.#...#.........#.....#...#
        #.#.###.#.#.#####.#.###############.###.#.###.#.#.#.#.#.###.#######.###.#.###.#.#.###.###.#########.###.#.#.#.#.#.#.###############.#########
        #.#.#...#.#.....#.#.#...#.......#...#...#.....#...#.#.#...#.#.....#.....#...#.#.#...#...#...#.....#.#...#.#...#.#.#.#...............#.....###
        #.#.#.###.#####.#.#.#.#.#.#####.#.###.#############.#.###.#.#.###.#########.#.#.###.###.###.#.###.#.#.###.#####.#.#.#.###############.###.###
        #.#.#...#.#...#.#.#...#.#.....#...###...........#...#...#.#.#...#...#.....#.#.#.....#...###.#...#...#...#.#...#.#.#.#.........#...###...#...#
        #.#.###.#.#.#.#.#.#####.#####.#################.#.#####.#.#.###.###.#.###.#.#.#######.#####.###.#######.#.#.#.#.#.#.#########.#.#.#####.###.#
        #.#.....#.#.#.#.#.......#.....#.....###...#...#.#...#...#.#...#.###...###.#.#.......#.#...#.#...###...#.#.#.#.#.#.#.#.........#.#...###...#.#
        #.#######.#.#.#.#########.#####.###.###.#.#.#.#.###.#.###.###.#.#########.#.#######.#.#.#.#.#.#####.#.#.#.#.#.#.#.#.#.#########.###.#####.#.#
        #.......#.#.#.#.........#.....#.#...#...#.#.#...#...#...#.###...#.........#...###...#...#...#.....#.#...#...#...#...#...#...###...#...#...#.#
        #######.#.#.#.#########.#####.#.#.###.###.#.#####.#####.#.#######.###########.###.###############.#.###################.#.#.#####.###.#.###.#
        #.......#...#.#...#...#.#.....#.#.#...#...#.....#.....#.#...#...#...........#...#.#...............#.#...................#.#.#...#...#...#...#
        #.###########.#.#.#.#.#.#.#####.#.#.###.#######.#####.#.###.#.#.###########.###.#.#.###############.#.###################.#.#.#.###.#####.###
        #...........#.#.#...#...#.#...#.#.#...#.#.....#...#...#.#...#.#...#...#...#.#...#.#.#...#...#...###.#...#...#...#.....#...#...#...#.#.....###
        ###########.#.#.#########.#.#.#.#.###.#.#.###.###.#.###.#.###.###.#.#.#.#.#.#.###.#.#.#.#.#.#.#.###.###.#.#.#.#.#.###.#.#########.#.#.#######
        #.....#...#.#.#...#.......#.#.#.#.#...#.#.#...###.#.....#.#...#...#.#...#.#.#.....#.#.#...#...#.#...#...#.#...#.#.#...#.....#.....#.#.......#
        #.###.#.#.#.#.###.#.#######.#.#.#.#.###.#.#.#####.#######.#.###.###.#####.#.#######.#.#########.#.###.###.#####.#.#.#######.#.#####.#######.#
        #...#.#.#...#.###.#.....###.#.#.#.#...#.#.#.#...#...#.....#...#...#...#...#.#.....#...#.....#...#...#.....#.....#.#.###.....#.....#.#.......#
        ###.#.#.#####.###.#####.###.#.#.#.###.#.#.#.#.#.###.#.#######.###.###.#.###.#.###.#####.###.#.#####.#######.#####.#.###.#########.#.#.#######
        #...#...#...#...#.#.....#...#.#.#...#.#...#...#...#.#.......#.#...###.#...#...#...#.....###.#.#...#.#.......#.....#...#.....#.....#.#...#...#
        #.#######.#.###.#.#.#####.###.#.###.#.###########.#.#######.#.#.#####.###.#####.###.#######.#.#.#.#.#.#######.#######.#####.#.#####.###.#.#.#
        #...#...#.#...#...#.#...#...#.#.#...#...........#.#...#.....#.#.#...#...#...#...#...#.....#...#.#.#.#.......#.....#...#...#.#...###.#...#.#.#
        ###.#.#.#.###.#####.#.#.###.#.#.#.#############.#.###.#.#####.#.#.#.###.###.#.###.###.###.#####.#.#.#######.#####.#.###.#.#.###.###.#.###.#.#
        #...#.#.#.#...#...#...#.....#...#.###...###...#.#...#.#.#...#.#.#.#...#...#...#...#...#...###...#...#.......#...#.#...#.#.#...#...#.#...#.#.#
        #.###.#.#.#.###.#.###############.###.#.###.#.#.###.#.#.#.#.#.#.#.###.###.#####.###.###.#####.#######.#######.#.#.###.#.#.###.###.#.###.#.#.#
        #...#.#...#...#.#.....#...#...#...#...#...#.#.#...#...#...#.#.#.#.#...###.....#.....#...#...#.......#.#...###.#.#...#...#...#.#...#.#...#.#.#
        ###.#.#######.#.#####.#.#.#.#.#.###.#####.#.#.###.#########.#.#.#.#.#########.#######.###.#.#######.#.#.#.###.#.###.#######.#.#.###.#.###.#.#
        ###...#...###...#...#...#...#.#.###.....#...#.#...#...#.....#.#.#.#.......###...#.....#...#...#...#.#.#.#.#...#.....#.......#.#.....#.....#.#
        #######.#.#######.#.#########.#.#######.#####.#.###.#.#.#####.#.#.#######.#####.#.#####.#####.#.#.#.#.#.#.#.#########.#######.#############.#
        ###.....#.........#...........#...#...#.#.....#.....#.#.#...#.#.#...#.....#...#.#.#...#...#...#.#.#.#.#.#.#...#.......#.....#.#.............#
        ###.#############################.#.#.#.#.###########.#.#.#.#.#.###.#.#####.#.#.#.#.#.###.#.###.#.#.#.#.#.###.#.#######.###.#.#.#############
        #...#...........................#.#.#.#.#...#.....#...#.#.#...#.#...#.#...#.#...#.#.#...#.#...#.#.#.#...#...#.#.#...###.#...#.#.....#...#...#
        #.###.#########################.#.#.#.#.###.#.###.#.###.#.#####.#.###.#.#.#.#####.#.###.#.###.#.#.#.#######.#.#.#.#.###.#.###.#####.#.#.#.#.#
        #.....###...#...................#...#...#...#...#.#.#...#.#...#.#.#...#.#.#...#...#...#.#...#.#.#...#.......#.#...#.....#...#.#...#...#...#.#
        #########.#.#.###########################.#####.#.#.#.###.#.#.#.#.#.###.#.###.#.#####.#.###.#.#.#####.#######.#############.#.#.#.#########.#
        #.........#...#.....#...#...............#.#...#.#...#...#...#.#.#.#...#.#.#...#...#...#.#...#.#.#.....#...#...#.....#.....#...#.#.........#.#
        #.#############.###.#.#.#.#############.#.#.#.#.#######.#####.#.#.###.#.#.#.#####.#.###.#.###.#.#.#####.#.#.###.###.#.###.#####.#########.#.#
        #.......#.......###...#...#.......#.....#...#...#.......#.....#.#...#.#.#.#...#...#...#.#.###.#.#...#...#.#.#...###...###.#...#.....#...#...#
        #######.#.#################.#####.#.#############.#######.#####.###.#.#.#.###.#.#####.#.#.###.#.###.#.###.#.#.###########.#.#.#####.#.#.#####
        #.......#.#.......#...#.....#...#...#.....###...#.......#.#...#.....#.#.#.#...#...#...#.#...#...###...#...#.#.###.......#...#.......#.#.....#
        #.#######.#.#####.#.#.#.#####.#.#####.###.###.#.#######.#.#.#.#######.#.#.#.#####.#.###.###.###########.###.#.###.#####.#############.#####.#
        #.#...#...#.....#...#.#.......#.......#...#...#.........#...#.....###...#.#.....#.#...#...#.....###...#.....#...#.#.....###...#.......#.....#
        #.#.#.#.#######.#####.#################.###.#####################.#######.#####.#.###.###.#####.###.#.#########.#.#.#######.#.#.#######.#####
        #...#...#...###.....#.#.................###.....#...#...#...#...#.....#...#...#.#.#...#...#.....#...#...........#.#.........#...#.....#.....#
        #########.#.#######.#.#.#######################.#.#.#.#.#.#.#.#.#####.#.###.#.#.#.#.###.###.#####.###############.###############.###.#####.#
        #.....#...#...#.....#.#.......#...............#.#.#.#.#.#.#.#.#...#...#.....#...#.#...#...#.....#.................#...........#...###.......#
        #.###.#.#####.#.#####.#######.#.#############.#.#.#.#.#.#.#.#.###.#.#############.###.###.#####.###################.#########.#.#############
        #...#.#.....#.#.....#.........#.#.......#...#.#...#.#.#.#.#.#.###.#...........#...#...#...#.....#...........#.....#.........#.#.#...........#
        ###.#.#####.#.#####.###########.#.#####.#.#.#.#####.#.#.#.#.#.###.###########.#.###.###.###.#####.#########.#.###.#########.#.#.#.#########.#
        #...#.#.....#.....#.....#...#...#.....#.#.#.#.....#.#.#.#.#.#.#...#...#...#...#...#...#.#...#.....#...#...#...###...#...#...#...#.#.........#
        #.###.#.#########.#####.#.#.#.#######.#.#.#.#####.#.#.#.#.#.#.#.###.#.#.#.#.#####.###.#.#.###.#####.#.#.#.#########.#.#.#.#######.#.#########
        #.#...#.#...#...#.......#.#...#.......#...#...#...#.#.#.#.#...#...#.#.#.#.#.....#.#...#.#.###...#...#...#.........#.#.#.#...#.....#.........#
        #.#.###.#.#.#.#.#########.#####.#############.#.###.#.#.#.#######.#.#.#.#.#####.#.#.###.#.#####.#.###############.#.#.#.###.#.#############.#
        #.#.###...#...#...........#...#.........#...#...###.#.#.#...#...#.#.#.#.#.....#.#...###.#...###...#...............#...#...#...#...#...#...#.#
        #.#.#######################.#.#########.#.#.#######.#.#.###.#.#.#.#.#.#.#####.#.#######.###.#######.#####################.#####.#.#.#.#.#.#.#
        #.#.....#####...............#.#...#.....#.#.......#.#.#.#...#.#...#.#.#.#...#.#.#.....#.#...#.....#...................#...#.....#...#...#.#.#
        #.#####.#####.###############.#.#.#.#####.#######.#.#.#.#.###.#####.#.#.#.#.#.#.#.###.#.#.###.###.###################.#.###.#############.#.#
        #.#...#...#...#.........#...#...#...###...#.......#...#.#.#...#...#.#.#...#.#...#...#.#...###...#.....................#...#.............#.#.#
        #.#.#.###.#.###.#######.#.#.###########.###.###########.#.#.###.#.#.#.#####.#######.#.#########.#########################.#############.#.#.#
        #.#.#...#.#.....#.....#.#.#...........#.#...###.......#...#.....#.#.#.#...#...#.....#.......###...............#.........#.#...#...#...#.#.#.#
        #.#.###.#.#######.###.#.#.###########.#.#.#####.#####.###########.#.#.#.#.###.#.###########.#################.#.#######.#.#.#.#.#.#.#.#.#.#.#
        #...###.#.......#...#.#.#.#...........#.#.#...#...#...#...###...#...#.#.#.#...#...........#.#...#...........#...#.......#.#.#...#...#...#...#
        #######.#######.###.#.#.#.#.###########.#.#.#.###.#.###.#.###.#.#####.#.#.#.#############.#.#.#.#.#########.#####.#######.#.#################
        #.....#.......#.....#.#.#.#.............#...#...#.#.###.#.....#.....#...#.#...#...........#.#.#.#.........#.......#...###...#.........#...###
        #.###.#######.#######.#.#.#####################.#.#.###.###########.#####.###.#.###########.#.#.#########.#########.#.#######.#######.#.#.###
        #...#.......#.....#...#...#.....#.............#...#.....#.....#...#...#...#...#...........#.#.#.#...#...#...........#.......#.#.......#.#...#
        ###.#######.#####.#.#######.###.#.###########.###########.###.#.#.###.#.###.#############.#.#.#.#.#.#.#.###################.#.#.#######.###.#
        ###.......#...#...#.###...#...#.#.......#...#.............###...#.....#.....###...#.......#...#...#...#...........#...#...#...#.......#.#...#
        #########.###.#.###.###.#.###.#.#######.#.#.###################################.#.#.#############################.#.#.#.#.###########.#.#.###
        #.........#...#...#.....#.....#.........#.#.#...#...#...###...#...#...###.......#...#.....#...#.................#.#.#...#.#...........#.#.###
        #.#########.#####.#######################.#.#.#.#.#.#.#.###.#.#.#.#.#.###.###########.###.#.#.#.###############.#.#.#####.#.###########.#.###
        #.#.......#.#####.........................#...#.#.#...#.....#...#...#...#...#...#...#.#...#.#.#.#...............#.#.....#...#.....#...#.#...#
        #.#.#####.#.###################################.#.#####################.###.#.#.#.#.#.#.###.#.#.#.###############.#####.#####.###.#.#.#.###.#
        #...#.....#...#...#........S###################...#####E#...............#...#.#...#...#.....#...#...#...........#.......#...#.#...#.#.#.#...#
        #####.#######.#.#.#.###################################.#.###############.###.#####################.#.#########.#########.#.#.#.###.#.#.#.###
        #.....#.....#...#...#.....#...#.....#...#...###########...#.......###...#...#.###...#...............#.#.........#.......#.#.#.#.....#...#...#
        #.#####.###.#########.###.#.#.#.###.#.#.#.#.###############.#####.###.#.###.#.###.#.#.###############.#.#########.#####.#.#.#.#############.#
        #.....#.###...#.....#.#...#.#.#.#...#.#...#.....#########...#...#...#.#...#.#.#...#.#.......#.....#...#...###...#.#.....#.#.#.#...........#.#
        #####.#.#####.#.###.#.#.###.#.#.#.###.#########.#########.###.#.###.#.###.#.#.#.###.#######.#.###.#.#####.###.#.#.#.#####.#.#.#.#########.#.#
        #...#...#.....#...#...#.....#...#.....#.....#...#########.#...#.....#.#...#...#...#.###...#...###...#...#.....#.#.#.#...#.#.#.#.#...#...#...#
        #.#.#####.#######.#####################.###.#.###########.#.#########.#.#########.#.###.#.###########.#.#######.#.#.#.#.#.#.#.#.#.#.#.#.#####
        #.#.#...#.........#.....#.....#.........###...#.....#.....#.....#...#.#...###...#.#.....#.....#...#...#.........#.#...#...#...#...#...#.....#
        #.#.#.#.###########.###.#.###.#.###############.###.#.#########.#.#.#.###.###.#.#.###########.#.#.#.#############.#########################.#
        #.#...#.#...###...#.#...#...#.#.........#.....#.#...#.....#.....#.#.#...#...#.#.#...#.......#.#.#...#.............#.............#.....#.....#
        #.#####.#.#.###.#.#.#.#####.#.#########.#.###.#.#.#######.#.#####.#.###.###.#.#.###.#.#####.#.#.#####.#############.###########.#.###.#.#####
        #.....#...#.#...#...#.......#...###.....#...#...#.#...#...#.......#.###.#...#.#...#...#...#.#.#.....#.###...#.......#...#.....#.#...#.#.....#
        #####.#####.#.#################.###.#######.#####.#.#.#.###########.###.#.###.###.#####.#.#.#.#####.#.###.#.#.#######.#.#.###.#.###.#.#####.#
        #.....#...#...#...#...#.......#.#...#.....#.#...#...#.#...#.........#...#.#...#...#...#.#.#.#...###...#...#...#.......#...#...#.....#.#.....#
        #.#####.#.#####.#.#.#.#.#####.#.#.###.###.#.#.#.#####.###.#.#########.###.#.###.###.#.#.#.#.###.#######.#######.###########.#########.#.#####
        #.....#.#.#.....#.#.#...#.....#.#.....#...#.#.#.......#...#...###...#.#...#...#...#.#.#.#.#.#...#...###.........#.........#.....#...#.#.....#
        #####.#.#.#.#####.#.#####.#####.#######.###.#.#########.#####.###.#.#.#.#####.###.#.#.#.#.#.#.###.#.#############.#######.#####.#.#.#.#####.#
        #...#...#...#.....#.#.....#...#.......#.#...#.#...#...#.....#.#...#...#...#...#...#.#...#.#.#.....#.#.........#...#.....#.......#.#.#.......#
        #.#.#########.#####.#.#####.#.#######.#.#.###.#.#.#.#.#####.#.#.#########.#.###.###.#####.#.#######.#.#######.#.###.###.#########.#.#########
        #.#.........#.......#.......#...#...#...#...#...#.#.#...#...#...#.........#.#...###.....#.#.....#...#.#.....#...#...#...###.......#...#...###
        #.#########.###################.#.#.#######.#####.#.###.#.#######.#########.#.#########.#.#####.#.###.#.###.#####.###.#####.#########.#.#.###
        #...#.....#...#...#...........#...#.....###.#.....#.#...#.#.....#.#...#.....#.#.......#.#.#.....#.###...#...#...#...#.....#.#.........#.#...#
        ###.#.###.###.#.#.#.#########.#########.###.#.#####.#.###.#.###.#.#.#.#.#####.#.#####.#.#.#.#####.#######.###.#.###.#####.#.#.#########.###.#
        ###...#...#...#.#.#.........#...........#...#.....#.#...#...#...#...#.#.....#.#.#.....#.#.#.....#.....#...###.#.....#...#...#.#...#...#.#...#
        #######.###.###.#.#########.#############.#######.#.###.#####.#######.#####.#.#.#.#####.#.#####.#####.#.#####.#######.#.#####.#.#.#.#.#.#.###
        #.....#...#.....#...#...###.........#...#...#.....#.#...#...#...#.....#...#.#.#.#.#...#.#.#...#.#.....#.......#.......#.#...#...#...#...#...#
        #.###.###.#########.#.#.###########.#.#.###.#.#####.#.###.#.###.#.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#############.#######.#.#.###############.#
        #...#.###.........#.#.#.....#.......#.#.#...#...#...#...#.#...#.#.....#.#.#.#.#.#.#.#.#.#.#.#.#.#.#...#...#...#.......#...#.....#.....#.....#
        ###.#.###########.#.#.#####.#.#######.#.#.#####.#.#####.#.###.#.#####.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#######.#########.#.###.#.#####
        #...#.............#...#.....#.......#.#.#...###.#.#####.#.#...#...#...#.#.#.#.#.#...#...#.#.#.#.#.#.#.#.#.#.#.#.......#.......#.#.#...#.....#
        #.#####################.###########.#.#.###.###.#.#####.#.#.#####.#.###.#.#.#.#.#########.#.#.#.#.#.#.#.#.#.#.#.#######.#####.#.#.#.#######.#
        #...#...........#...#...#...###.....#.#.#...#...#...#...#.#.#...#.#.#...#...#.#.....#.....#.#.#.#.#.#.#.#.#.#.#...#...#...#...#...#...#.....#
        ###.#.#########.#.#.#.###.#.###.#####.#.#.###.#####.#.###.#.#.#.#.#.#.#######.#####.#.#####.#.#.#.#.#.#.#.#.#.###.#.#.###.#.#########.#.#####
        ###...#.....###...#.#.....#.....#...#.#...###.....#.#...#.#...#...#.#.......#...#...#...#...#...#.#.#.#.#.#.#...#...#.....#.......#...#.....#
        #######.###.#######.#############.#.#.###########.#.###.#.#########.#######.###.#.#####.#.#######.#.#.#.#.#.###.#################.#.#######.#
        ###...#...#.......#...#.....#...#.#.#.....#.......#...#.#.....#.....#.......###.#...#...#...#.....#.#...#.#...#...#.....#.......#.#...#...#.#
        ###.#.###.#######.###.#.###.#.#.#.#.#####.#.#########.#.#####.#.#####.#########.###.#.#####.#.#####.#####.###.###.#.###.#.#####.#.###.#.#.#.#
        #...#...#.......#.###.#.###...#.#.#.#.....#.........#.#.#...#.#.#...#.........#.#...#...#...#.....#.....#.#...#...#...#.#...###...###.#.#...#
        #.#####.#######.#.###.#.#######.#.#.#.#############.#.#.#.#.#.#.#.#.#########.#.#.#####.#.#######.#####.#.#.###.#####.#.###.#########.#.#####
        #...#...#.....#.#.....#.#.....#.#.#.#.......#.......#.#.#.#.#.#.#.#.#.....#...#.#...#...#.....#...#...#.#.#.#...#...#.#.#...#...#...#.#.#...#
        ###.#.###.###.#.#######.#.###.#.#.#.#######.#.#######.#.#.#.#.#.#.#.#.###.#.###.###.#.#######.#.###.#.#.#.#.#.###.#.#.#.#.###.#.#.#.#.#.#.#.#
        #...#...#...#.#.....#...#...#...#.#.#.......#...#.....#.#.#.#.#.#.#.#.#...#...#...#.#.#...#...#.#...#.#.#...#...#.#.#.#.#.....#...#.#.#...#.#
        #.#####.###.#.#####.#.#####.#####.#.#.#########.#.#####.#.#.#.#.#.#.#.#.#####.###.#.#.#.#.#.###.#.###.#.#######.#.#.#.#.###########.#.#####.#
        #.#...#.....#.......#...###.....#.#.#...###.....#.#.....#.#.#.#.#.#.#.#.#.....#...#.#.#.#.#.###.#...#.#...#...#.#.#.#.#.....#.......#.....#.#
        #.#.#.#################.#######.#.#.###.###.#####.#.#####.#.#.#.#.#.#.#.#.#####.###.#.#.#.#.###.###.#.###.#.#.#.#.#.#.#####.#.###########.#.#
        #.#.#...#...#.........#...#.....#.#...#...#.#...#.#.#...#.#.#.#.#.#.#.#.#.....#...#.#...#.#...#.#...#.#...#.#.#.#.#.#.#.....#...........#.#.#
        #.#.###.#.#.#.#######.###.#.#####.###.###.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#.#####.###.#.#####.###.#.#.###.#.###.#.#.#.#.#.#.###############.#.#.#
        #.#.#...#.#.#.#.......#...#.#...#.#...#...#.#.#...#.#.#.#.#.#.#.#.#.#.#.......###...#...#.#...#...###.#.....#.#...#.#.#...#...#.......#.#.#.#
        #.#.#.###.#.#.#.#######.###.#.#.#.#.###.###.#.#####.#.#.#.#.#.#.#.#.#.###############.#.#.#.#########.#######.#####.#.###.#.#.#.#####.#.#.#.#
        #.#.#.....#.#.#.#.....#...#...#...#.#...###.#.#.....#.#...#.#.#.#.#.#...#...###.......#...#.###.....#...#...#.....#.#.###.#.#.#...###...#...#
        #.#.#######.#.#.#.###.###.#########.#.#####.#.#.#####.#####.#.#.#.#.###.#.#.###.###########.###.###.###.#.#.#####.#.#.###.#.#.###.###########
        #.#.###...#.#.#.#...#...#.......#...#.....#...#.#...#.#.....#.#.#.#...#...#...#.......#...#...#...#...#.#.#.#...#.#.#.#...#.#...#...###...###
        #.#.###.#.#.#.#.###.###.#######.#.#######.#####.#.#.#.#.#####.#.#.###.#######.#######.#.#.###.###.###.#.#.#.#.#.#.#.#.#.###.###.###.###.#.###
        #.#.#...#...#.#...#.#...#...#...#.....#...###...#.#...#.#.....#...#...#...#...###.....#.#...#.....#...#.#.#...#.#.#...#.#...###...#.....#...#
        #.#.#.#######.###.#.#.###.#.#.#######.#.#####.###.#####.#.#########.###.#.#.#####.#####.###.#######.###.#.#####.#.#####.#.#######.#########.#
        #.#.#.......#...#...#.#...#.#.....#...#.....#...#.#.....#.......#...#...#.#.....#.#...#...#.#...#...#...#.....#.#...###.#.....#...#.....#...#
        #.#.#######.###.#####.#.###.#####.#.#######.###.#.#.###########.#.###.###.#####.#.#.#.###.#.#.#.#.###.#######.#.###.###.#####.#.###.###.#.###
        #.#.###.....#...#.....#...#.#...#.#...#.....###.#.#.....#.....#.#...#.#...#...#.#.#.#.....#.#.#.#.###...#.....#...#...#...#...#...#...#.#.###
        #.#.###.#####.###.#######.#.#.#.#.###.#.#######.#.#####.#.###.#.###.#.#.###.#.#.#.#.#######.#.#.#.#####.#.#######.###.###.#.#####.###.#.#.###
        #.#.#...#...#...#...#...#.#.#.#.#.#...#.....#...#.....#.#...#.#...#.#.#.#...#.#.#.#.#.......#.#.#.....#.#.......#...#...#.#.....#...#.#.#...#
        #.#.#.###.#.###.###.#.#.#.#.#.#.#.#.#######.#.#######.#.###.#.###.#.#.#.#.###.#.#.#.#.#######.#.#####.#.#######.###.###.#.#####.###.#.#.###.#
        #...#.....#.....###...#...#...#...#.........#.........#.....#.....#...#...###...#...#.........#.......#.........###.....#.......###...#.....#
        #############################################################################################################################################
    """.trimIndent()
    val parsed = parse(input)
    println(run1(parsed, 100))
    println(run2(parsed, 100))
}
